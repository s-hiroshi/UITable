<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/TableSchema.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/customException.html">customException</a></li>
                                <li><a href="../classes/entry.html">entry</a></li>
                                <li><a href="../classes/preview.html">preview</a></li>
                                <li><a href="../classes/schema.html">schema</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/UITable.html">UITable</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/TableSchema.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Handle table schema.
 *
 * @class schema
 */
export default (function () {

    /**
     * @property exception
     * @public
     * @type {object}
     */
    let exception;

    /**
     * Set error handle object.
     * 
     * @method setException
     * @public
     * @param {Object} ex
     */
    function setException(ex) {
        exception = ex;
    }

    /**
     * @property contextColMenu
     * @private
     * @type {String}
     */
    const contextColMenu = &#x60;&lt;span class=&quot;it-table-context&quot;&gt;
                    &lt;a class=&quot;it-table-show-context btn btn-default btn-sm&quot; href=&quot;#&quot;&gt;&lt;i class=&quot;fa fa-cog&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; Settings&lt;/a&gt;
                    &lt;ul class=&quot;it-table-context-menu it-table-display-none&quot;&gt;
                        &lt;li class=&quot;it-table-add-col&quot;&gt;&lt;i class=&quot;fa fa-plus&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&amp;emsp;Add Col&lt;/li&gt;
                        &lt;li class=&quot;it-table-rm-col&quot;&gt;&lt;i class=&quot;fa fa-minus&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&amp;emsp;Del Col&lt;/li&gt;
                        &lt;li class=&quot;it-table-convert-col-th&quot;&gt;&lt;i class=&quot;fa fa-arrow-right&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&amp;emsp;TH&lt;/li&gt;
                        &lt;li class=&quot;it-table-convert-col-td&quot;&gt;&lt;i class=&quot;fa fa-arrow-right&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&amp;emsp;TD&lt;/li&gt;
                        &lt;li class=&quot;it-table-close-context&quot;&gt;&lt;i class=&quot;fa fa-times&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&amp;emsp;Close&lt;/li&gt;
                    &lt;/ul&gt;
                    &lt;/span&gt;&#x60;;
    /**
     * @property contextRowMenu 
     * @private
     * @type {String}
     */
    const contextRowMenu = &#x60;&lt;span class=&quot;it-table-context&quot;&gt;
                    &lt;a class=&quot;it-table-show-context btn btn-default btn-sm&quot; href=&quot;#&quot;&gt;&lt;i class=&quot;fa fa-cog&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; Settings&lt;/a&gt;
                    &lt;ul class=&quot;it-table-context-menu it-table-display-none&quot;&gt;
                        &lt;li class=&quot;it-table-add-row&quot;&gt;&lt;i class=&quot;fa fa-plus&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&amp;emsp;Add Row&lt;/li&gt;
                        &lt;li class=&quot;it-table-rm-row&quot;&gt;&lt;i class=&quot;fa fa-minus&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&amp;emsp;Del Row&lt;/li&gt;
                        &lt;li class=&quot;it-table-convert-row-th&quot;&gt;&lt;i class=&quot;fa fa-arrow-right&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&amp;emsp;TH&lt;/li&gt;
                        &lt;li class=&quot;it-table-convert-row-td&quot;&gt;&lt;i class=&quot;fa fa-arrow-right&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&amp;emsp;TD&lt;/li&gt;
                        &lt;li class=&quot;it-table-close-context&quot;&gt;&lt;i class=&quot;fa fa-times&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&amp;emsp;Close&lt;/li&gt;
                    &lt;/ul&gt;
                    &lt;/span&gt;&#x60;;

    /**
     * Make table schema.
     *
     * @method makeSchema
     * @public
     * @param params
     *   @param {Object} params.schema jQuery object of that has it-table-schema class.
     *   @param {Number} params.rowsLength Number of row.
     *   @param {Number} params.colsLength Number of cols.
     * @returns {Object} jQuery object of that has it-table schema class.
     */
    function makeSchema( params ) {
        let schema = params.schema;
        const rowsLength = params.rowsLength;
        const colsLength = params.colsLength;
        if ( !rowsLength &gt; 0 || !colsLength &gt; 0 ) {
            exception.output( {
                message: &#x27;Input th number greater than 0.&#x27;,
                type: &#x27;alert&#x27;
            } );
            return false;
        }

        // Make row for adding col.
        const head = $( &#x27;&lt;div class=&quot;it-table-add-col-area&quot;&gt;&#x27; );
        for ( var k = 0; k &lt; colsLength; k++ ) {
            if ( k === 0 ) {
                $( &#x27;&lt;span class=&quot;it-table-blank&quot;&gt;&amp;nbsp;&lt;/span&gt;&#x27; ).appendTo( head );
            }
            $( contextColMenu ).appendTo( head );
        }
        head.appendTo( schema );

        // Make rows for table data.
        for ( var i = 0; i &lt; rowsLength; i++ ) {
            var row = $( &#x27;&lt;div class=&quot;it-table-row&quot;&gt;&#x27; ).appendTo( schema );
            for ( var j = 0; j &lt; colsLength; j++ ) {
                if ( j === 0 ) {
                    $( contextRowMenu ).appendTo( row );
                }
                var entryMarkup = &#x60;&lt;span class=&quot;btn btn-default it-table-entry&quot;&gt;
                                       Edit &lt;i class=&quot;fa fa-pencil-square-o&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;
                                       &lt;input type=&quot;hidden&quot; name=&quot;content[]&quot;&gt;
                                       &lt;input type=&quot;hidden&quot; name=&quot;th[]&quot;&gt;
                                  &lt;/span&gt;&#x60;;
                $( entryMarkup ).appendTo( row );
            }
        }
        $( &#x27;input[name=&quot;showRowsLength&quot;]&#x27; ).prop(&#x27;disabled&#x27;, true);
        $( &#x27;input[name=&quot;showColsLength&quot;]&#x27; ).prop(&#x27;disabled&#x27;, true);
        
        setHandler( schema );

        return schema;
    }

    /**
     * Set event handler that handle row and column.
     * 
     * @method setHandler
     * @public
     * @param {Object} schema jQuery object that identifies target.
     */
    function setHandler( schema ) {
        setRowHandler( schema );
        setColHandler( schema );
    }

    /**
     * Set event handler that handle row.
     *
     * @method setRowHandler
     * @private
     * @param {Object} schema jQuery object that identifies target.
     */
    function setRowHandler( schema ) {
        $( &#x27;.it-table-add-row&#x27;, schema ).click( addRow );
        $( &#x27;.it-table-rm-row&#x27;, schema ).click( removeRow );
        $( &#x27;.it-table-convert-row-th&#x27;, schema ).click( convertRowToTh );
        $( &#x27;.it-table-convert-row-td&#x27;, schema ).click( convertRowToTd );
    }

    /**
     * Set event Handler that handle column.
     *
     * @method setColHandler
     * @private
     * @param {Object} schema jQuery object that identifies target.
     */
    function setColHandler( schema ) {
        $( &#x27;.it-table-add-col&#x27;, schema ).click( addCol( schema ) );
        $( &#x27;.it-table-rm-col&#x27;, schema ).click( removeCol( schema ) );
        $( &#x27;.it-table-convert-col-th&#x27;, schema ).click( convertColToTh( schema ) );
        $( &#x27;.it-table-convert-col-td&#x27;, schema ).click( convertColToTd( schema ) );
    }

    /**
     * Show context menu.
     *
     * @method showContext
     * @public
     * @returns {boolean}
     */
    function showContext() {
        $( &#x27;.it-table-context-menu&#x27; ).remove( &#x27;it-table-display&#x27; );
        $( &#x27;.it-table-context-menu&#x27; ).addClass( &#x27;it-table-display-none&#x27; );
        const context = $( this ).next();
        context.removeClass( &#x27;it-table-display-none&#x27; );
        context.addClass( &#x27;it-table-display&#x27; );
        return false;
    }

    /**
     * Close context menu.
     *
     * @method closeContext
     * @public
     * @returns {boolean}
     */
    function closeContext() {
        const context = $( this ).parents( &#x27;.it-table-context-menu&#x27; );
        context.remove( &#x27;it-table-display&#x27; );
        context.addClass( &#x27;it-table-display-none&#x27; );
        return false;
    }

    /**
     * Add row.
     *
     * @method addRow
     * @private
     * @return {Boolean} false.
     */
    function addRow() {
        const row = $( this ).parents( &#x27;.it-table-row&#x27; );
        const menu = $( &#x27;.it-table-context-menu&#x27;, row );
        menu.removeClass( &#x27;it-table-display&#x27; );
        menu.addClass( &#x27;it-table-display-none&#x27; );
        const addedRow = row.clone( true );
        const addedInput = $( &#x27;input[name=&quot;content[]&quot;]&#x27;, addedRow );
        addedInput.val( &#x27;&#x27; );
        addedInput.parent().removeClass( &#x27;it-table-th&#x27; );
        addedInput.parent().addClass( &#x27;it-table-td&#x27; );
        addedInput.parent().removeClass( &#x27;it-table-data-fill&#x27; );
        $( &#x27;i&#x27;, addedInput.parent() ).removeClass( &#x27;fa-pencil-square&#x27; );
        $( &#x27;i&#x27;, addedInput.parent() ).addClass( &#x27;fa-pencil-square-o&#x27; );
        $( &#x27;input[name=&quot;th[]&quot;]&#x27;, addedRow ).val( &#x27;false&#x27; );
        row.before( addedRow );
        incRowsLength();
        return false;
    }

    /**
     * Remove Row.
     *
     * @method removeRow
     * @private
     * @return {Boolean}
     */
    function removeRow() {
        if ( $( &#x27;.it-table-row&#x27; ).length &lt; 2 ) {
            return false;
        }
        const row = $( this ).parents( &#x27;.it-table-row&#x27; );
        row.remove();
        decRowsLength();
        return false;
    }

    /**
     * Convert row to th (Table Header).
     *
     * @method convertRowToTh
     * @private
     * @return {Boolean}
     */
    function convertRowToTh() {
        const row = $( this ).parents( &#x27;.it-table-row&#x27; );
        const data = $( &#x27;input[name=&quot;th[]&quot;]&#x27;, row );
        const menu = $( &#x27;.it-table-context-menu&#x27;, row );
        data.each( function () {
            $( this ).val( &#x27;true&#x27; );
            $( this ).parent().removeClass( &#x27;it-table-td&#x27; );
            $( this ).parent().addClass( &#x27;it-table-th&#x27; )

        } );
        menu.removeClass( &#x27;it-table-display&#x27; );
        menu.addClass( &#x27;it-table-display-none&#x27; );
        return false;
    }

    /**
     * Convert row to td (Table Data.
     *
     * @method convertRowToTd
     * @private
     * @return {Boolean}
     */
    function convertRowToTd() {
        const row = $( this ).parents( &#x27;.it-table-row&#x27; );
        const data = $( &#x27;input[name=&quot;th[]&quot;]&#x27;, row );
        const menu = $( &#x27;.it-table-context-menu&#x27;, row );
        data.each( function () {
            $( this ).val( &#x27;false&#x27; );
            $( this ).parent().removeClass( &#x27;it-table-th&#x27; );
            $( this ).parent().addClass( &#x27;it-table-td&#x27; );
        } );
        menu.removeClass( &#x27;it-table-display&#x27; );
        menu.addClass( &#x27;it-table-display-none&#x27; );
        return false;
    }

    /**
     * Add column.
     *
     * @method addCol
     * @private
     * @param {Object} schema jQuery object of that has it-table-schema class.
     * @return {Function}
     */
    function addCol( schema ) {
        return function () {
            const rowsLength = $( &#x27;div&#x27;, schema ).length;
            const colsLength = $( &#x27;div:first-child span&#x27;, schema ).length;
            const index = getIndex( $( this ).parents( &#x27;.it-table-context&#x27; ), &#x27;.it-table-add-col-area span&#x27; );
            for ( var i = 0; i &lt; rowsLength; i++ ) {
                const row = schema.children().eq( i );
                for ( var j = 0; j &lt; colsLength; j++ ) {
                    if ( j === index ) {
                        if ( i === 0 ) {
                            $( &#x27;.it-table-context-menu&#x27;, row ).removeClass( &#x27;it-table-display&#x27; );
                            $( &#x27;.it-table-context-menu&#x27;, row ).addClass( &#x27;it-table-display-none&#x27; );
                        }
                        const col = row.children().eq( j );
                        const addedCol = col.clone( true );
                        $( &#x27;input[name=&quot;content[]&quot;]&#x27;, addedCol ).val( &#x27;&#x27; );
                        $( &#x27;input[name=&quot;th[]&quot;]&#x27;, addedCol ).val( &#x27;false&#x27; );
                        if ( j &gt; 0 &amp;&amp; i !== 0) {
                            $( &#x27;i&#x27;, addedCol ).removeClass( &#x27;fa fa-pencil-square&#x27; );
                            $( &#x27;i&#x27;, addedCol ).addClass( &#x27;fa fa-pencil-square-o&#x27; );
                        }
                        addedCol.removeClass( &#x27;it-table-th&#x27; );
                        addedCol.addClass( &#x27;it-table-td&#x27; );
                        addedCol.removeClass( &#x27;it-table-data-fill&#x27; );
                        col.before( addedCol );
                    }
                }
            }
            incColsLength();
            return false;
        }
    }

    /**
     * Remove column.
     *
     * @method removeCol
     * @private
     * @param {Object} schema jQuery object of that has it-table-schema class.
     * @return {Function}
     */
    function removeCol( schema ) {
        return function () {
            const rowsLength = $( &#x27;div&#x27;, schema ).length;
            const colsLength = $( &#x27;div:first-child span&#x27;, schema ).length;
            if ( colsLength &lt;= 2 ) {
                return false;
            }
            const index = getIndex( $( this ).parents( &#x27;.it-table-context&#x27; ), &#x27;.it-table-add-col-area span&#x27; );
            for ( var i = 0; i &lt; rowsLength; i++ ) {
                const row = schema.children().eq( i );
                for ( var j = 0; j &lt; colsLength; j++ ) {
                    if ( j === index ) {
                        const col = row.children().eq( j );
                        col.remove();
                    }
                }
            }
            decColsLength();
            return false;
        }
    }

    /**
     * Convert column to th.
     *
     * @method convertColToTh
     * @private
     * @param {Object} schema jQuery object of that has it-table-schema class.
     * @return {Function}
     */
    function convertColToTh( schema ) {
        return function () {
            const rowsLength = $( &#x27;div&#x27;, schema ).length;
            const colsLength = $( &#x27;div:first-child span&#x27;, schema ).length;
            const index = getIndex( $( this ).parents( &#x27;.it-table-context&#x27; ), &#x27;.it-table-add-col-area span&#x27; );
            for ( var i = 0; i &lt; rowsLength; i++ ) {
                const row = schema.children().eq( i );
                for ( var j = 0; j &lt; colsLength; j++ ) {
                    if ( j === index ) {
                        if ( i === 0 ) {
                            $( &#x27;.it-table-context-menu&#x27;, row ).removeClass( &#x27;it-table-display&#x27; );
                            $( &#x27;.it-table-context-menu&#x27;, row ).addClass( &#x27;it-table-display-none&#x27; );
                        }
                        const col = row.children().eq( j );
                        const input = $( &#x27;input[name=&quot;th[]&quot;]&#x27;, col );

                        input.val( &#x27;true&#x27; );
                        input.parent().removeClass( &#x27;it-table-td&#x27; );
                        input.parent().addClass( &#x27;it-table-th&#x27; )
                    }
                }
            }
            return false;
        }
    }

    /**
     * Convert column to td.
     *
     * @method convertColToTd
     * @private
     * @param {Object} schema jQuery object of that has it-table-schema class.
     * @return {Function}
     */
    function convertColToTd( schema ) {
        return function () {
            const rowsLength = $( &#x27;div&#x27;, schema ).length;
            const colsLength = $( &#x27;div:first-child span&#x27;, schema ).length;
            const index = getIndex( $( this ).parents( &#x27;.it-table-context&#x27; ), &#x27;.it-table-add-col-area span&#x27; );
            for ( var i = 0; i &lt; rowsLength; i++ ) {
                const row = schema.children().eq( i );
                for ( var j = 0; j &lt; colsLength; j++ ) {
                    if ( j === index ) {
                        if ( i === 0 ) {
                            $( &#x27;.it-table-context-menu&#x27;, row ).removeClass( &#x27;it-table-display&#x27; );
                            $( &#x27;.it-table-context-menu&#x27;, row ).addClass( &#x27;it-table-display-none&#x27; );
                        }
                        const col = row.children().eq( j );
                        const input = $( &#x27;input[name=&quot;th[]&quot;]&#x27;, col );
                        input.val( &#x27;false&#x27; );
                        input.parent().removeClass( &#x27;it-table-th&#x27; );
                        input.parent().addClass( &#x27;it-table-td&#x27; );
                    }
                }
            }
            return false;
        }
    }

    /**
     * Row length increment.
     *
     * @method incRowsLength
     * @private
     */
    function incRowsLength() {
        const rowsLength = $( &#x27;input[name=&quot;rowsLength&quot;]&#x27; );
        const showRowsLength = $( &#x27;input[name=&quot;showRowsLength&quot;]&#x27; );
        rowsLength.val( parseInt( rowsLength.val(), 10 ) + 1 );
        showRowsLength.prop( &#x27;disabled&#x27;, false );
        showRowsLength.val( parseInt( rowsLength.val(), 10 ) );
        showRowsLength.prop( &#x27;disabled&#x27;, true );
    }

    /**
     * Row length decrement.
     *
     * @method decRowsLength
     * @private
     */
    function decRowsLength() {
        let rowsLength = $( &#x27;input[name=&quot;rowsLength&quot;]&#x27; );
        const showRowsLength = $( &#x27;input[name=&quot;showRowsLength&quot;]&#x27; );
        rowsLength.val( parseInt( rowsLength.val(), 10 ) - 1 );
        showRowsLength.prop( &#x27;disabled&#x27;, false );
        showRowsLength.val( parseInt( rowsLength.val(), 10 ) );
        showRowsLength.prop( &#x27;disabled&#x27;, true );
    }

    /**
     * Column length increment.
     *
     * @method incColsLength
     * @private
     */
    function incColsLength() {
        const colsLength = $( &#x27;input[name=&quot;colsLength&quot;]&#x27; );
        const showColsLength = $( &#x27;input[name=&quot;showColsLength&quot;]&#x27; );
        colsLength.val( parseInt( colsLength.val(), 10 ) + 1 );
        showColsLength.prop( &#x27;disabled&#x27;, false );
        showColsLength.val( parseInt( colsLength.val(), 10 ) );
        showColsLength.prop( &#x27;disabled&#x27;, true );
    }

    /**
     * Column length decrement.
     *
     * @method decColsLength
     * @private
     */
    function decColsLength() {
        const colsLength = $( &#x27;input[name=&quot;colsLength&quot;]&#x27; );
        const showColsLength = $( &#x27;input[name=&quot;showColsLength&quot;]&#x27; );
        colsLength.val( parseInt( colsLength.val(), 10 ) - 1 );
        showColsLength.prop( &#x27;disabled&#x27;, false );
        showColsLength.val( parseInt( colsLength.val(), 10 ) );
        showColsLength.prop( &#x27;disabled&#x27;, true );
    }

    /**
     * Get index for parent element.
     *
     * @method getIndex
     * @private
     * @param {jQuery} target Child element.
     * @param {String} selector css selector of Parent element.
     * @return {Number}
     */
    function getIndex( target, selector ) {
        return $( selector ).index( target );
    }

    return {
        makeSchema: makeSchema,
        showContext: showContext,
        closeContext: closeContext,
        setHandler: setHandler,
        setException: setException
    };
}());

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
